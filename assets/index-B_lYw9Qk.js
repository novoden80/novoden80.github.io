var e=Object.defineProperty,t=(t,s,i)=>((t,s,i)=>s in t?e(t,s,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[s]=i)(t,"symbol"!=typeof s?s+"":s,i);import{p as s}from"./phaser-CwoquCe3.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const s of e)if("childList"===s.type)for(const e of s.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();class i extends s.Scene{constructor(){super("Boot")}preload(){this.load.image("background","assets/bg.png")}create(){this.scene.start("Preloader")}}var a=(e=>(e[e.PLAYER=0]="PLAYER",e[e.ENEMY=1]="ENEMY",e))(a||{});class h extends s.Physics.Arcade.Sprite{constructor(e,s,i,a,h){super(e,s,i,a),t(this,"shipType"),t(this,"speed",150),t(this,"rotationSpeed",.03),t(this,"cannonCooldown",0),t(this,"cannonCooldownMax",1e3),t(this,"health",100),t(this,"scene"),this.shipType=h,this.scene=e,this.health=100,e.add.existing(this),e.physics.add.existing(this),this.setCollideWorldBounds(!0),this.setBounce(.2),this.setDamping(!0),this.setDrag(.95),this.setMaxVelocity(this.speed),this.setOrigin(.5,.5)}update(e,t,s){0===this.shipType&&s?this.updatePlayerShip(s):1===this.shipType&&this.updateEnemyShip(e),this.cannonCooldown>0&&(this.cannonCooldown-=t)}updatePlayerShip(e){var t,s,i,a;(null==(t=e.left)?void 0:t.isDown)?this.rotation-=this.rotationSpeed:(null==(s=e.right)?void 0:s.isDown)&&(this.rotation+=this.rotationSpeed);const h=this.scene;h&&h.physics&&((null==(i=e.up)?void 0:i.isDown)?h.physics.velocityFromRotation(this.rotation,this.speed,this.body.velocity):(null==(a=e.down)?void 0:a.isDown)&&h.physics.velocityFromRotation(this.rotation,-this.speed/2,this.body.velocity))}updateEnemyShip(e){if(e%3e3<20){this.rotation=s.Math.FloatBetween(0,2*Math.PI);const e=this.scene;e&&e.physics&&e.physics.velocityFromRotation(this.rotation,.7*this.speed,this.body.velocity)}e%5e3<20&&this.cannonCooldown<=0&&(this.fireCannonLeft(),this.fireCannonRight())}fireCannonLeft(){if(this.cannonCooldown<=0){const e=this.rotation-Math.PI/2,t=30*Math.cos(e),s=30*Math.sin(e);if(this.createCannonball(this.x+t,this.y+s,e))return this.cannonCooldown=this.cannonCooldownMax,!0}return!1}fireCannonRight(){if(this.cannonCooldown<=0){const e=this.rotation+Math.PI/2,t=30*Math.cos(e),s=30*Math.sin(e);if(this.createCannonball(this.x+t,this.y+s,e))return this.cannonCooldown=this.cannonCooldownMax,!0}return!1}createCannonball(e,t,s){const i=this.scene;if(!i||!i.physics)return null;const a=i.physics.add.sprite(e,t,"cannonball");return a.setScale(.5),i.cannonballs&&i.cannonballs.add(a),i.physics.velocityFromRotation(s,300,a.body.velocity),i.time.delayedCall(2e3,(()=>{a&&a.active&&a.destroy()})),a}takeDamage(e){this.health-=e,this.health<0&&(this.health=0),console.log(`${0===this.shipType?"Player":"Enemy"} ship health: ${this.health}`),this.active&&this.scene&&this.scene.tweens&&this.scene.tweens.add({targets:this,alpha:.5,duration:100,yoyo:!0,repeat:3});const t=this.scene;t&&t.updateHealthDisplay&&t.updateHealthDisplay(),this.health<=0&&(this.health=0,this.body&&this.body.setVelocity(0,0),console.log("Ship destroyed: "+(0===this.shipType?"Player":"Enemy")))}getHealth(){return this.health}getType(){return this.shipType}}class n extends s.Scene{constructor(){super("Game"),t(this,"camera"),t(this,"sea"),t(this,"playerShip"),t(this,"enemyShip"),t(this,"islands"),t(this,"cursors"),t(this,"spaceKey"),t(this,"cannonballs"),t(this,"playerHealthText"),t(this,"enemyHealthText"),t(this,"gameWidth",1024),t(this,"gameHeight",768),t(this,"gameEnding",!1)}create(){this.camera=this.cameras.main,this.camera.setBackgroundColor(30654),this.sea=this.add.tileSprite(0,0,this.gameWidth,this.gameHeight,"sea").setOrigin(0,0).setScrollFactor(.8),this.cannonballs=this.physics.add.group(),this.createIslands(),this.playerShip=new h(this,200,this.gameHeight/2,"player-ship",a.PLAYER),this.enemyShip=new h(this,this.gameWidth-200,this.gameHeight/2,"enemy-ship",a.ENEMY),this.physics.add.collider(this.playerShip,this.islands),this.physics.add.collider(this.enemyShip,this.islands),this.physics.add.collider(this.playerShip,this.enemyShip),this.physics.add.collider(this.cannonballs,this.islands,this.handleCannonballIslandCollision,null,this),console.log("Setting up player ship collision handler"),this.physics.add.collider(this.cannonballs,this.playerShip,((e,t)=>{console.log("PLAYER SHIP HIT!"),e.destroy();const s=this.add.sprite(t.x,t.y,"explosion");s.setScale(2),s.play("explode"),t.setVisible(!1),t.setActive(!1),this.scene.start("GameOver",{won:!1})}),null,this),console.log("Setting up enemy ship collision handler"),this.physics.add.collider(this.cannonballs,this.enemyShip,((e,t)=>{console.log("ENEMY SHIP HIT!"),e.destroy(),this.enemyShip.takeDamage(10);const s=this.add.sprite(t.x,t.y,"explosion");s.setScale(2),s.play("explode"),t.setVisible(!1),t.setActive(!1),this.scene.start("GameOver",{won:!0})}),null,this),this.cursors=this.input.keyboard.createCursorKeys(),this.spaceKey=this.input.keyboard.addKey(s.Input.Keyboard.KeyCodes.SPACE),this.playerHealthText=this.add.text(20,20,"Player: 100",{fontFamily:"Arial",fontSize:"18px",color:"#ffffff"}),this.enemyHealthText=this.add.text(this.gameWidth-150,20,"Enemy: 100",{fontFamily:"Arial",fontSize:"18px",color:"#ffffff"});const e=this.add.text(this.gameWidth/2,50,"Arrow keys to move, SPACE to fire cannons",{fontFamily:"Arial",fontSize:"16px",color:"#ffffff"}).setOrigin(.5);this.tweens.add({targets:e,alpha:0,duration:2e3,delay:5e3})}update(e,t){this.playerShip&&this.playerShip.active&&(this.playerShip.update(e,t,this.cursors),Phaser.Input.Keyboard.JustDown(this.spaceKey)&&(this.playerShip.fireCannonLeft(),this.playerShip.fireCannonRight())),this.enemyShip&&this.enemyShip.active&&this.enemyShip.update(e,t),this.updateHealthDisplay(),this.sea.tilePositionX+=.2}updateHealthDisplay(){this.playerShip&&this.playerShip.active?this.playerHealthText.setText(`Player: ${this.playerShip.getHealth()}`):this.playerHealthText.setText("Player: 0"),this.enemyShip&&this.enemyShip.active?this.enemyHealthText.setText(`Enemy: ${this.enemyShip.getHealth()}`):this.enemyHealthText.setText("Enemy: 0")}createIslands(){this.islands=this.add.group();const e=["island1","island2","island3"];for(let t=0;t<5;t++){const s=Phaser.Math.Between(150,this.gameWidth-150),i=Phaser.Math.Between(150,this.gameHeight-150),a=Phaser.Math.Distance.Between(s,i,200,this.gameHeight/2),h=Phaser.Math.Distance.Between(s,i,this.gameWidth-200,this.gameHeight/2);if(a<150||h<150){t--;continue}const n=e[Phaser.Math.Between(0,e.length-1)],o=this.add.image(s,i,n);this.physics.world.enable(o),o.body.setImmovable(!0),this.islands.add(o),this.addPalmTreesToIsland(o)}}addPalmTreesToIsland(e){const t=Phaser.Math.Between(1,3);for(let s=0;s<t;s++){const t=Phaser.Math.Between(-e.width/3,e.width/3),s=Phaser.Math.Between(-e.height/3,e.height/3),i=this.add.image(e.x+t,e.y+s,"palm");i.setScale(.7),i.setDepth(e.y+10)}}handleCannonballIslandCollision(e){e.destroy()}handleCannonballShipCollision(e,t){if(e.destroy(),t===this.playerShip){if(console.log("Player ship hit!"),this.playerShip.takeDamage(10),this.playerShip.getHealth()<=0){const e=this.add.sprite(this.playerShip.x,this.playerShip.y,"explosion");e.setScale(2),e.play("explode"),this.playerShip.setVisible(!1),this.playerShip.setActive(!1),console.log("Player ship destroyed - Game Over (Loss)"),this.time.delayedCall(1e3,(()=>{this.scene.start("GameOver",{won:!1})}))}}else if(t===this.enemyShip){console.log("Enemy ship hit - GAME OVER!");const e=this.add.sprite(this.enemyShip.x,this.enemyShip.y,"explosion");e.setScale(2),e.play("explode"),this.enemyShip.setVisible(!1),this.enemyShip.setActive(!1),this.scene.start("GameOver",{won:!0})}}endGame(e){this.gameEnding=!0,console.log("Game ending: Player "+(e?"won":"lost"));const t=e?this.enemyShip:this.playerShip,s=this.add.sprite(t.x,t.y,"explosion");s.setScale(2),s.play("explode"),t.setActive(!1),t.setVisible(!1),this.input.keyboard.enabled=!1,this.time.delayedCall(1500,(()=>{this.scene.start("GameOver",{won:e})}))}}class o extends s.Scene{constructor(){super("GameOver"),t(this,"camera"),t(this,"sea"),t(this,"gameoverText"),t(this,"instructionText"),t(this,"gameWidth",1024),t(this,"gameHeight",768),t(this,"won",!1)}init(e){this.won=e.won}create(){this.camera=this.cameras.main,this.camera.setBackgroundColor(30654),this.sea=this.add.tileSprite(0,0,this.gameWidth,this.gameHeight,"sea").setOrigin(0,0).setScrollFactor(.8).setAlpha(.7),this.add.rectangle(0,0,this.gameWidth,this.gameHeight,0,.5).setOrigin(0,0);const e=this.won?"Victory!":"Defeat!",t=this.won?"#ffff00":"#ff0000";this.gameoverText=this.add.text(this.gameWidth/2,this.gameHeight/2-50,e,{fontFamily:"Arial Black",fontSize:64,color:t,stroke:"#000000",strokeThickness:8,align:"center"}),this.gameoverText.setOrigin(.5);const s=this.won?"You defeated the enemy ship!":"Your ship was destroyed!";this.add.text(this.gameWidth/2,this.gameHeight/2+20,s,{fontFamily:"Arial",fontSize:28,color:"#ffffff",align:"center"}).setOrigin(.5),this.instructionText=this.add.text(this.gameWidth/2,this.gameHeight/2+80,"Click or tap to return to the main menu",{fontFamily:"Arial",fontSize:24,color:"#ffffff",align:"center"}),this.instructionText.setOrigin(.5),this.tweens.add({targets:this.instructionText,alpha:.5,duration:1e3,yoyo:!0,repeat:-1}),this.input.once("pointerdown",(()=>{this.scene.start("MainMenu")}))}update(){this.sea.tilePositionX+=.1}}class l extends s.Scene{constructor(){super("MainMenu"),t(this,"sea"),t(this,"logo"),t(this,"title"),t(this,"startText"),t(this,"gameWidth",1024),t(this,"gameHeight",768),t(this,"ships",[])}create(){this.sea=this.add.tileSprite(0,0,this.gameWidth,this.gameHeight,"sea").setOrigin(0,0).setScrollFactor(.8),this.createDecorativeIslands(),this.createDecorativeShips(),this.logo=this.add.image(this.gameWidth/2,200,"logo"),this.title=this.add.text(this.gameWidth/2,300,"NAVAL BATTLE",{fontFamily:"Arial Black",fontSize:64,color:"#ffffff",stroke:"#000000",strokeThickness:8,align:"center"}).setOrigin(.5),this.startText=this.add.text(this.gameWidth/2,400,"Click or tap to start",{fontFamily:"Arial",fontSize:32,color:"#ffffff",stroke:"#000000",strokeThickness:4,align:"center"}).setOrigin(.5),this.tweens.add({targets:this.startText,scale:1.1,duration:800,yoyo:!0,repeat:-1}),this.input.once("pointerdown",(()=>{this.scene.start("Game")}))}update(){this.sea.tilePositionX+=.5;for(const e of this.ships)e.x+=e.getData("speedX"),e.y+=e.getData("speedY"),e.x>this.gameWidth+100&&(e.x=-100),e.x<-100&&(e.x=this.gameWidth+100),e.y>this.gameHeight+100&&(e.y=-100),e.y<-100&&(e.y=this.gameHeight+100)}createDecorativeIslands(){const e=["island1","island2","island3"];for(let t=0;t<3;t++){const t=Phaser.Math.Between(100,this.gameWidth-100),s=Phaser.Math.Between(500,this.gameHeight-100),i=e[Phaser.Math.Between(0,e.length-1)],a=this.add.image(t,s,i);a.setScale(.7),a.setAlpha(.7);const h=Phaser.Math.Between(1,2);for(let e=0;e<h;e++){const e=Phaser.Math.Between(-a.width/4,a.width/4),i=Phaser.Math.Between(-a.height/4,a.height/4),h=this.add.image(t+e,s+i,"palm");h.setScale(.5),h.setDepth(s+1),h.setAlpha(.7)}}}createDecorativeShips(){const e=["player-ship","enemy-ship"];for(let t=0;t<4;t++){const t=Phaser.Math.Between(0,this.gameWidth),s=Phaser.Math.Between(500,this.gameHeight),i=e[Phaser.Math.Between(0,e.length-1)],a=this.add.sprite(t,s,i);a.setScale(.7),a.setAlpha(.6),a.rotation=Phaser.Math.FloatBetween(0,2*Math.PI);const h=Phaser.Math.FloatBetween(.2,.8),n=Phaser.Math.FloatBetween(0,2*Math.PI);a.setData("speedX",Math.cos(n)*h),a.setData("speedY",Math.sin(n)*h),this.ships.push(a)}}}class r extends s.Scene{constructor(){super("Preloader")}init(){this.add.image(512,384,"background"),this.add.rectangle(512,384,468,32).setStrokeStyle(1,16777215);const e=this.add.rectangle(282,384,4,28,16777215);this.load.on("progress",(t=>{e.width=4+460*t}))}preload(){this.load.setPath("assets"),this.load.image("logo","logo.png"),this.load.image("sea","sea.png"),this.load.image("island1","island1.png"),this.load.image("island2","island2.png"),this.load.image("island3","island3.png"),this.load.image("player-ship","ships/player-ship.png"),this.load.image("enemy-ship","ships/enemy-ship.png"),this.load.image("cannonball","ships/cannonball.png"),this.load.image("palm","palm.png"),this.load.spritesheet("explosion","explosion.png",{frameWidth:64,frameHeight:64})}create(){this.anims.create({key:"explode",frames:this.anims.generateFrameNumbers("explosion",{start:0,end:15}),frameRate:20,repeat:0}),this.scene.start("MainMenu")}}const d={type:Phaser.AUTO,width:1024,height:768,parent:"game-container",backgroundColor:"#028af8",scale:{mode:Phaser.Scale.FIT,autoCenter:Phaser.Scale.CENTER_BOTH},physics:{default:"arcade",arcade:{gravity:{y:0},debug:!1}},scene:[i,r,l,n,o]};new s.Game(d);
